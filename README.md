# КПО ДЗ 3
- Матусевич Дмитрий Сергеевич
- БПИ243

Простая микросервисная система.
Написана на Spring Boot, использует PostgreSQL для данных и Docker для запуска.

## Функционал

1.  **Загрузка работ**:
    *   Принимаются файлы исходного кода: `.java`, `.cpp`, `.cs`, `.py`, `.kt`, а также `.txt`, `.md`, `.tex`.
    *   Ограничение по размеру: **100 КБ** (защита от "мусора").
    *   Метаданные (имя студента, название задачи) сохраняются в базу.

2.  **Анализ**:
    *   Сравнивает загруженную работу с другими работами **по той же задаче**.
    *   Если имена студентов разные, а **содержимое файлов совпадает один-в-один** — фиксируется плагиат (100%) - здесь самая примитивная система сравнения, так как суть дз вроде не в ней.
    *   Результат проверки сохраняется.

3.  **Визуализация (Word Cloud)**:
    *   Генерирует облако слов из текста работы.
    *   Использует внешний API (QuickChart.io).
    *   Доступно по адресу: `GET /reports/word-cloud/{id}` (возвращает PNG).

## Технологии
*   **Java 17**, **Spring Boot 3**
*   **PostgreSQL 15** (в Docker контейнере)
*   **Docker & Docker Compose**
*   **Gradle**

## Структура
*   `api-gateway`: Входная точка (port 8080).
*   `file-storing-service`: Загрузка и скачивание файлов (port 8081).
*   `file-analysis-service`: Логика проверки (port 8082).

## Запуск

### Перед первым запуском
Если пересобираете проект или меняете настройки базы, лучше очистить старые данные:
```bash
docker compose down -v
```

### Основной вариант (Docker)
Самый простой способ. Всё соберется и запустится само.
```bash
docker compose up -d --build
```
*Нужно подождать пару минут, пока скачаются образы и Gradle.*

### Вариант 2: Запуск с pre-built JAR (быстрее)
Если не хотите ждать сборку внутри Docker. Требует локальной **Java 17+.**

1.  **Соберите JAR файлы локально**:
    ```bash
    ./gradlew build -x test
    ```
    *(На Windows используйте `gradlew.bat`, ну я использовал, хотя и обычный должен работать)*

2.  **Запустите prod-конфигурацию**:
    ```bash
    docker compose -f docker-compose.prod.yml up -d --build
    ```
    В этом режиме Docker просто берет готовые jar-файлы из папки `build/libs` и упаковывает их, что гораздо быстрее.

### Swagger UI (Документация)
После запуска интерфейс доступен по адресу:
**[http://localhost:8080/swagger-ui.html](http://localhost:8080/swagger-ui.html)**

> **Важно!**
> В правом верхнем углу в поле **Select a definition** можно переключаться между сервисами:
> *   `file-storing-service` — загрузка файлов.
> *   `file-analysis-service` — запуск проверки и получение отчетов.
